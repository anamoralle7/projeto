<!-- Cabecalho principal  -->
<%- include('../partials/header') %>

<!-- Conteudo do index  -->
<main class="container text-center mt-3 ">
    <h1> LISTA DE USUÁRIOS </h1>
    <a href="usuarios/cadastrar">
        <button class="btn btn-lg btn-primary">
            <!-- icone do bootstrap -->
            <i class="bi bi-plus-circle"></i>
            cadastrar
        </button>
    </a>

    <!-- criando tbela de acordo co a lista de usuarios -->

   <%  if (usuarios && usuarios.length > 0 ) { %>
    <!-- criando a tabela -->
     <table class="table table-striped table-hover align-middle mt-5 ">
        <!-- cabecalho da tabela -->
        <thead class="table-dark">
            <tr class="text-center">
                <th scope="col"> ID</th>
                <th  scope="col"> usuario</th>
                <th  scope="col">E-mail</th>
                <th  scope="col">tipo</th>
                <th  scope="col">ações</th>
            </tr>
        </thead>
        <!-- corpo da tabela -->
        <tbody>
            <!-- usando a funcao foreach para percorrer o array de usuarios   -->
            <% usuarios.forEach((usuario) => { %>
                <tr>
                    <td><%= usuario.id %></td>
                    <td><%= usuario.usuario %></td>
                    <td><%= usuario.email %></td>
                    <td><%= usuario.tipo %></td>
                    <td>
                     <a href="/usuarios/<%= usuario.id %>" style="text-decoration:none;" >
                        <button class="btn btn-sm btn-warning me-2">
                            <i class="bi bi-pencil-square"></i>
                            editar
                            </button>
                            </a>
                                                                               <a href="#">
                        <button class="btn btn-sm btn-danger"
                        onclick="confirmaExclusao('<%= usuario.usuario%>','<%= usuario.id %>')"
                        >
                            <i class="bi bi-trash3"></i>
                            excluir
                        </button>
                    </a>
                </td>
                </tr>
           <% }) %>
        </tbody>
     </table>

    <% } else { %>
        <!-- mostra uma mensagem, caso não tenha nenhum usuario cadastrado -->
        <div class="alert alet-warning text-center mt-5">
            nenhum usuario cadastrado no momento.
        </div>
        <% } %>

        <!-- ciaçao do script para funçao de deletar -->
        <script>
            function confirmaExclusao(nomeUsuario, id){
                if(confirm(`Deseja realmnte excluir o usuario ${nomeUsuario}`)){
                window.location.href = `/usuarios/deletar/${id}`
                 }
            }

        </script>
     
</main>

<!-- Rodape de todas as páginas  -->
<%- include('../partials/footer') %>